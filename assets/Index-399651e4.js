import{_ as G,an as J,u as Q,o as W,r as v,a as X,h as Y,b as d,c as h,d as e,t as f,ab as a,w as o,ax as Z,f as w,g as D,aq as ee,E as te,O as $,i as I,az as se,ap as N,aA as ae,at as oe,p as ne,j as le}from"./index-550fe8a6.js";import{d as ie,E as ce}from"./el-select-36627619.js";import{b as de,a as re}from"./el-table-column-0b36586f.js";import{j as T}from"./challenge-cbc6c818.js";import{f as L}from"./tool-4fbdb15c.js";import"./isEqual-b8955e6d.js";import"./_initCloneObject-b521214e.js";import"./index-e30dcb43.js";import"./flatten-c595264c.js";const l=g=>(ne("data-v-f59f3cee"),g=g(),le(),g),he={class:"container"},ue={class:"title mb24"},_e={class:"flex-between mb16"},pe={class:"flex-center"},fe=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-Search"})],-1)),ge=l(()=>e("svg",{class:"icon mr8","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-Delete"})],-1)),me={class:"icon mr8","aria-hidden":"true",style:{"font-size":"12px"}},be=l(()=>e("use",{"xlink:href":"#icon-chuangjian"},null,-1)),ve=[be],ke={class:"expand-panel"},Ce=l(()=>e("div",{class:"title mb16"},"Challenge_phases：",-1)),$e=["innerHTML"],xe={class:"flex"},ye=["onClick"],Se=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-bianji"})],-1)),ze=[Se],Ee=["onClick"],Pe=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-Delete"})],-1)),we=[Pe],De=["onClick"],Ie={key:0,class:"round-status success"},Ne=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-xuanzhe"})],-1)),Te=[Ne],Le={key:1,class:"round-status error"},Ve=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-qingchu"})],-1)),Be=[Ve],je={key:0,class:"round-status success"},qe=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-xuanzhe"})],-1)),Me=[qe],Ae={key:1,class:"round-status error"},He=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-qingchu"})],-1)),Ke=[He],Ue={key:0,class:"round-status success"},Oe=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-xuanzhe"})],-1)),Re=[Oe],Fe={key:1,class:"round-status error"},Ge=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-qingchu"})],-1)),Je=[Ge],Qe={class:"flex"},We=["onClick"],Xe=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-bianji"})],-1)),Ye=[Xe],Ze=["onClick"],et=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-HostedChallenge"})],-1)),tt=[et],st=["onClick"],at=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-Delete"})],-1)),ot=[at],nt={__name:"Index",setup(g){const{t:x}=J(),m=Q(),V=()=>{m.push("/host/challenge/add")};W(()=>{_()});const k=v(""),y=v([]),r=X({total:0,pageNum:1,pageSize:10}),S=()=>{r.pageNum=1,_()},b=v([]),B=t=>{b.value=t},z=v(),j=()=>{z.value.clearSelection()},_=()=>{Y("all","all","all",{page:r.pageNum,title:k.value}).then(t=>{let n=t.results||[];n.forEach(u=>{u.phaseList=[],u.loadPhases=!1}),y.value=n,r.total=t.count})},q=t=>{m.push(`/host/challenge/edit/${t.id}`)},M=t=>{m.push(`/host/phase/add/${t.id}`)},A=t=>{se(t.id).then(n=>{N.success(x("host.deleteSuccess")),_()})},H=()=>{},K=(t,n)=>{m.push(`/host/phase/edit/${t.id}/${n.id}`)},U=(t,n)=>{ae(t.id,n.id).then(u=>{N.success(x("host.phaseDeleteSuccess")),T(t.id).then(C=>{t.phaseList=C.results||[],t.loadPhases=!0})})},O=(t,n)=>{t.loadPhases||T(t.id).then(u=>{t.phaseList=u.results||[],t.loadPhases=!0})};return(t,n)=>{const u=ee,C=ie,E=te,i=re,p=oe,P=de,R=ce;return d(),h("div",he,[e("div",ue,f(t.$t("host.ChallList")),1),e("div",_e,[e("div",pe,[a(u,{modelValue:k.value,"onUpdate:modelValue":n[0]||(n[0]=s=>k.value=s),placeholder:t.$t("search"),clearable:"",style:{width:"240px"},onKeyup:Z(S,["enter"]),onClear:S},{prefix:o(()=>[fe]),_:1},8,["modelValue","placeholder","onKeyup"]),b.value.length>0?(d(),w(C,{key:0,class:"ml16 custom-selected-tag",size:"large",type:"info",closable:"",style:{"border-radius":"3px"},onClose:j},{default:o(()=>[$(" 已选择"+f(b.value.length)+"项 ",1)]),_:1})):D("",!0),b.value.length>0?(d(),w(E,{key:1,type:"danger",class:"ml16",onClick:n[1]||(n[1]=s=>H())},{default:o(()=>[ge,$(" 批量删除 ")]),_:1})):D("",!0)]),a(E,{type:"primary",class:"ml16",onClick:V},{default:o(()=>[(d(),h("svg",me,ve)),$(" "+f(t.$t("addChall.createChall")),1)]),_:1})]),a(P,{data:y.value,stripe:"",style:{width:"100%"},ref_key:"multipleTableRef",ref:z,"header-cell-class-name":"thBg",onExpandChange:O,"row-key":"id",onSelectionChange:B},{default:o(()=>[a(i,{type:"expand"},{default:o(s=>[e("div",ke,[Ce,a(P,{data:s.row.phaseList,"show-header":!1},{default:o(()=>[a(i,{label:"Name",prop:"name",width:"250"}),a(i,{label:"Description",prop:"description"},{default:o(({row:c})=>[e("div",{innerHTML:c.description},null,8,$e)]),_:1}),a(i,{label:t.$t("operate"),width:"100"},{default:o(({row:c})=>[e("div",xe,[a(p,{class:"box-item",effect:"light",content:t.$t("edit"),placement:"top-start"},{default:o(()=>[e("span",{class:"icon-button",onClick:F=>K(s.row,c)},ze,8,ye)]),_:2},1032,["content"]),a(p,{class:"box-item",effect:"light",content:t.$t("delete"),placement:"top-start"},{default:o(()=>[e("span",{class:"icon-button",onClick:F=>U(s.row,c)},we,8,Ee)]),_:2},1032,["content"])])]),_:2},1032,["label"])]),_:2},1032,["data"])])]),_:1}),a(i,{prop:"id",label:"ID",width:"100"}),a(i,{prop:"title",label:t.$t("host.title")},{default:o(({row:s})=>[e("div",{class:"underline",onClick:c=>t.$router.push(`/host/challenge/${s.id}`)},f(s.title),9,De)]),_:1},8,["label"]),a(i,{prop:"start_date",label:t.$t("host.startDate_utc"),formatter:s=>I(L)(s.start_date)},null,8,["label","formatter"]),a(i,{prop:"end_date",label:t.$t("host.endDate_utc"),formatter:s=>I(L)(s.end_date)},null,8,["label","formatter"]),a(i,{prop:"creator",label:t.$t("host.creator"),width:"150"},{default:o(({row:s})=>{var c;return[e("span",null,f((c=s.creator)==null?void 0:c.created_by),1)]}),_:1},8,["label"]),a(i,{prop:"published",label:t.$t("host.publicyAvailable"),width:"150"},{default:o(({row:s})=>[s.published?(d(),h("span",Ie,Te)):(d(),h("span",Le,Be))]),_:1},8,["label"]),a(i,{prop:"is_registration_open",label:t.$t("host.isRegistrationOpen"),width:"150"},{default:o(({row:s})=>[s.is_registration_open?(d(),h("span",je,Me)):(d(),h("span",Ae,Ke))]),_:1},8,["label"]),a(i,{prop:"enable_forum",label:t.$t("host.enableForum"),width:"150"},{default:o(({row:s})=>[s.enable_forum?(d(),h("span",Ue,Re)):(d(),h("span",Fe,Je))]),_:1},8,["label"]),a(i,{label:t.$t("operate"),width:"150"},{default:o(({row:s})=>[e("div",Qe,[a(p,{class:"box-item",effect:"light",content:t.$t("edit"),placement:"top-start"},{default:o(()=>[e("span",{class:"icon-button",onClick:c=>q(s)},Ye,8,We)]),_:2},1032,["content"]),a(p,{class:"box-item",effect:"light",content:t.$t("host.createPhases"),placement:"top-start"},{default:o(()=>[e("span",{class:"icon-button",onClick:c=>M(s)},tt,8,Ze)]),_:2},1032,["content"]),a(p,{class:"box-item",effect:"light",content:t.$t("delete"),placement:"top-start"},{default:o(()=>[e("span",{class:"icon-button",onClick:c=>A(s)},ot,8,st)]),_:2},1032,["content"])])]),_:1},8,["label"])]),_:1},8,["data"]),a(R,{"hide-on-single-page":"",background:"",layout:"prev, pager, next",total:r.total,"page-size":r.pageSize,"onUpdate:pageSize":n[2]||(n[2]=s=>r.pageSize=s),"current-page":r.pageNum,"onUpdate:currentPage":n[3]||(n[3]=s=>r.pageNum=s),onSizeChange:_,onCurrentChange:_,class:"mt24 oa-pagination"},null,8,["total","page-size","current-page"])])}}},ft=G(nt,[["__scopeId","data-v-f59f3cee"]]);export{ft as default};
